/* ===================================
   منطقة التحرير والصفحة
   =================================== */
.editor-area {
  flex-grow: 1;
  display: flex;
  justify-content: center;
  padding: 30px 20px 60px;
  overflow-y: auto;
}

/* ===================================
   ورقة السيناريو (الصفحة)
   =================================== */
.screenplay-sheet {
  width: var(--page-width);
  min-height: var(--page-height);
  background-color: var(--color-page-bg);
  box-shadow: var(--shadow-page);
  display: flex;
  flex-direction: column;
  position: relative;
  overflow: hidden;
}

/* Paged mode keeps legacy header/footer spacing while allowing dynamic document growth. */
.screenplay-sheet.filmlane-sheet-paged {
  height: auto;
  min-height: var(--page-height);
}

/* Keep page overlays above the editor content so footer/header markers stay visible. */
.screenplay-sheet.filmlane-sheet-paged .screenplay-sheet__header,
.screenplay-sheet.filmlane-sheet-paged .screenplay-sheet__body,
.screenplay-sheet.filmlane-sheet-paged .screenplay-sheet__footer {
  position: relative;
  z-index: 1;
}

.screenplay-sheet.filmlane-sheet-paged .filmlane-page-overlays {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 3;
}

.screenplay-sheet.filmlane-sheet-paged .filmlane-page-divider {
  position: absolute;
  left: 0;
  right: 0;
  height: 1px;
  background: rgba(0, 0, 0, 0.12);
}

.screenplay-sheet.filmlane-sheet-paged .filmlane-page-header-band,
.screenplay-sheet.filmlane-sheet-paged .filmlane-page-footer-band {
  position: absolute;
  left: 0;
  right: 0;
  background: var(--color-page-bg);
}

.screenplay-sheet.filmlane-sheet-paged .filmlane-page-header-band {
  box-shadow: inset 0 -1px 0 rgba(0, 0, 0, 0.08);
}

.screenplay-sheet.filmlane-sheet-paged .filmlane-page-footer-band {
  box-shadow: inset 0 1px 0 rgba(0, 0, 0, 0.08);
}

.screenplay-sheet.filmlane-sheet-paged .filmlane-page-number-marker {
  position: absolute;
  left: var(--page-margin-left);
  font-family: var(--font-family-editor);
  font-size: 12pt;
  color: #111111;
}

/* In paged mode, page numbers are rendered by overlays per-page. */
.screenplay-sheet.filmlane-sheet-paged .screenplay-page-number {
  display: none;
}

.screenplay-sheet__header {
  height: var(--page-header-height);
  width: 100%;
  flex-shrink: 0;
}

.screenplay-sheet__footer {
  height: var(--page-footer-height);
  width: 100%;
  flex-shrink: 0;
}

.screenplay-sheet__body {
  flex-grow: 1;
  width: 100%;
  padding-left: var(--page-margin-left);
  padding-right: var(--page-margin-right);
  outline: none;
  font-family: var(--font-family-editor);
  font-size: 12pt;
  line-height: 15pt;
  direction: rtl;
  color: black;
  white-space: pre-wrap;
  box-sizing: border-box;
  user-select: text !important;
  -webkit-user-select: text !important;
  -moz-user-select: text !important;
  cursor: text;
  overflow-wrap: break-word;
  word-wrap: break-word;
  font-weight: bold;
}

/* ===================================
   أنماط عناصر السيناريو
   =================================== */

/* البسملة (Basmala) */
.screenplay-basmala {
  text-align: left;
  direction: rtl;
  width: 100%;
  font-weight: bold;
  margin: 0;
  min-height: 15pt;
  line-height: 15pt;
  padding: 4pt 0;
}

/* خط رأس المشهد العلوي - التجميع البصري */
/* يعرض scene-header-1 و scene-header-2 على نفس السطر */
.screenplay-scene-header-top-line {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  width: 100%;
  font-weight: normal;
  margin-top: 12pt;
  padding: 2pt 0;
  min-height: 15pt;
  line-height: 15pt;
}

.screenplay-scene-header-1 {
  flex: 0 0 auto;
  font-weight: normal;
  min-height: 15pt;
  line-height: 15pt;
  padding: 0;
  margin: 0;
}

.screenplay-scene-header-1::after {
  content: ':';
}

.screenplay-scene-header-2 {
  flex: 0 0 auto;
  font-weight: normal;
  min-height: 15pt;
  line-height: 15pt;
  padding: 0;
  margin: 0;
}

.screenplay-scene-header-3 {
  text-align: center;
  font-weight: normal;
  min-height: 15pt;
  line-height: 15pt;
  padding: 2pt 0;
  margin-bottom: 6pt;
}

/* الوصف / الحركة (Action) */
.screenplay-action {
  text-align: justify;
  text-align-last: right;
  width: 100%;
  margin: 0;
  margin-top: 15pt;
  min-height: 15pt;
  line-height: 15pt;
  padding: 2pt 0;
  font-weight: bold;
}

/* اسم الشخصية (Character) */
.screenplay-character {
  width: 4.1in;
  text-align: center;
  margin: 0 auto;
  min-height: 15pt;
  line-height: 15pt;
  padding: 6pt 0 2pt;
  font-weight: bold;
}

/* تعليمات الحوار (Parenthetical) */
.screenplay-parenthetical {
  text-align: center;
  margin: 0 auto;
  min-height: 15pt;
  line-height: 15pt;
  padding: 2pt 0;
  font-weight: bold;
}

/* الحوار (Dialogue) */
.screenplay-dialogue {
  width: 4.1in;
  text-align: center;
  margin: 0 auto;
  font-weight: bold;
  padding-left: 1.5em;
  padding-right: 1em;
  padding-top: 0.25em;
  padding-bottom: 0;
  min-height: 15pt;
  line-height: 15pt;
}

/* الانتقال (Transition) */
.screenplay-transition {
  text-align: center;
  margin: 0 auto;
  margin-top: 15pt;
  font-weight: bold;
  min-height: 15pt;
  line-height: 15pt;
  padding: 6pt 0;
}

/* ===================================
   أنماط المحرر (Tiptap)
   =================================== */

/* إزالة الحدود الافتراضية */
.tiptap {
  outline: none !important;
  border: none !important;
}

.tiptap:focus {
  outline: none !important;
}

/* مؤشر المكان الفارغ (Placeholder) */
.tiptap .is-empty::before {
  content: attr(data-placeholder);
  color: #aaaaaa;
  pointer-events: none;
  float: right;
  height: 0;
  font-style: italic;
}

/* تنسيق النص المحدد */
.tiptap ::selection {
  background-color: rgba(0, 120, 212, 0.2);
}

/* تأثير العنصر النشط */
.tiptap .has-focus {
  background-color: var(--color-active-element-bg);
  border-radius: 2px;
}

/* معاينة الطباعة */
@media print {
  body {
    background: white;
  }

  .toolbar {
    display: none !important;
  }

  .editor-area {
    padding: 0;
  }

  .screenplay-sheet {
    box-shadow: none;
    width: 100%;
  }
}
